/* jshint devel:true */

(function ($) {
  'use strict';
  $(document).ready(function () {
    $.slidebars({
      scrollLock: true
    });

    $('.b-menu').on('click','.b-sub-menu,.b-sub-menu__header', function () {
      var $this = $(this);
      //$this.toggleClass('expanded');
      $this.parent().toggleClass('expanded');
    });

    $('.b-menu').on('click', '.b-sub-menu__link', function (event) {
      event.stopPropagation();
    });
    var data = [{'Label':'Start','Link':'http://www.expressen.se/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Nöje','Link':'http://www.expressen.se/noje/','HideInTopLevelMenu':false,'Items':[{'Label':'Extra','Link':'http://www.expressen.se/noje/extra/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'Sport','Link':'http://www.expressen.se/sport/','HideInTopLevelMenu':false,'Items':[{'Label':'Fotboll','Link':'http://www.expressen.se/sport/fotboll/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Hockey','Link':'http://www.expressen.se/sport/hockey/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Målservice','Link':'http://www.expressen.se/malservice','HideInTopLevelMenu':true,'Items':[]},{'Label':'Trav','Link':'http://www.expressen.se/sport/trav/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Spel & tips','Link':'http://www.expressen.se/sport/spel-och-tips/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'TV','Link':'http://www.expressen.se/tv/','HideInTopLevelMenu':false,'Items':[{'Label':'Nyheter','Link':'http://www.expressen.se/tv/nyheter/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Nöje','Link':'http://www.expressen.se/tv/noje/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Sport','Link':'http://www.expressen.se/tv/sport/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Program','Link':'http://www.expressen.se/tv/program/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Primetime','Link':'http://www.expressen.se/tv/nyheter/primetime/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Galna klipp','Link':'http://www.expressen.se/tv/galna-klipp/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'GT','Link':'http://www.expressen.se/gt/','HideInTopLevelMenu':true,'Items':[{'Label':'Nöje','Link':'http://www.expressen.se/gt/noje/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Kultur','Link':'http://www.expressen.se/gt/kultur/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Ledare','Link':'http://www.expressen.se/gt/ledare/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Sport','Link':'http://www.expressen.se/gt/sport/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'Kvällsposten','Link':'http://www.expressen.se/kvallsposten/','HideInTopLevelMenu':true,'Items':[{'Label':'Nöje','Link':'http://www.expressen.se/kvp/noje/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Kultur','Link':'http://www.expressen.se/kvp/kultur/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Ledare','Link':'http://www.expressen.se/kvp/ledare/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Sport','Link':'http://www.expressen.se/kvp/sport/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'Allt om resor','Link':'http://www.expressen.se/allt-om-resor/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Bloggar','Link':'http://www.expressen.se/blogg/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Debatt','Link':'http://www.expressen.se/debatt/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Hälsoliv','Link':'http://www.expressen.se/halsoliv/','HideInTopLevelMenu':true,'Items':[{'Label':'Hälsa','Link':'http://www.expressen.se/halsoliv/halsa/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Vikt','Link':'http://www.expressen.se/halsoliv/vikt/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Psykologi','Link':'http://www.expressen.se/halsoliv/psykologi/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Träning','Link':'http://www.expressen.se/halsoliv/traning/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Sömn','Link':'http://www.expressen.se/halsoliv/somn/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Sex & relationer','Link':'http://www.expressen.se/halsoliv/sex--relationer/','HideInTopLevelMenu':false,'Items':[]},{'Label':'Hälsovikt','Link':'http://www.expressen.se/halsoliv/halsovikt/','HideInTopLevelMenu':false,'Items':[{'Label':'Veckomenyer','Link':'/halsoliv/halsovikt/veckomenyer/?diet=lchf&week=1','HideInTopLevelMenu':false,'Items':[]},{'Label':'Sök recept','Link':'/halsoliv/halsovikt/sok','HideInTopLevelMenu':false,'Items':[]},{'Label':'Testa – vilken diet passar dig?','Link':'/halsoliv/halsovikt/test','HideInTopLevelMenu':false,'Items':[]},{'Label':'Dietcoacher','Link':'/halsoliv/halsovikt/dietcoach/','HideInTopLevelMenu':false,'Items':[]}]}]},{'Label':'Kultur','Link':'http://www.expressen.se/kultur/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Krönikörer','Link':'http://www.expressen.se/kronikorer/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Ledare','Link':'http://www.expressen.se/ledare/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Leva & bo','Link':'http://www.expressen.se/leva-och-bo/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Livsstil','Link':'','HideInTopLevelMenu':true,'Items':[{'Label':'Allt om bilar','Link':'http://www.expressen.se/motor/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Allt om mode','Link':'http://www.expressen.se/mode/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Digital Livsstil','Link':'http://www.expressen.se/digital-livsstil/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Röda mattan', 'Link':'http://rodamattan.expressen.se/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'Mitt kök','Link':'http://mittkok.expressen.se/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Podcast','Link':'http://www.expressen.se/podcast/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Quiz','Link':'http://www.expressen.se/webbtest/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Tipsa 71717','Link':'http://www.expressen.se/nyheter/basta-nyhetsbilden-belonas-med-71717-kr/','HideInTopLevelMenu':true,'Items':[]},{'Label':'Tjänster','Link':'','HideInTopLevelMenu':true,'Items':[{'Label':'Målservice','Link':'http://expressen.se/malservice','HideInTopLevelMenu':true,'Items':[]},{'Label':'TV-tablå','Link':'http://expressen.se/tvtabla/','HideInTopLevelMenu':true,'Items':[]}]},{'Label':'Väder','Link':'http://www.expressen.se/vader/','HideInTopLevelMenu':true,'Items':[]}];
    var template = '{#.}<li class="b-menu__item">{?.Items}<span class="b-sub-menu__header">{Label}</span><ul class="b-sub-menu"><li class="b-sub-menu__item"><a href="{Link}" class="b-sub-menu__link">Start</a></li>{#Items}<li class="b-sub-menu__item"><a href="{Link}" class="b-sub-menu__link">{Label}</a></li>{~n}{/Items}</ul>{:else}<a class="b-menu__link" href="{Link}">{Label}</a>{/.Items}</li>{/.}';
    /*global dust */
    var compiled = dust.compile(template, 'menu-template');
    dust.loadSource(compiled);

      dust.render('menu-template', data, function(err, out) {
        $('.b-menu').html(out);
      });

  });
})(jQuery);
